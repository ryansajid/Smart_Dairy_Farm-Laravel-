Since youâ€™re already using **Spatie Laravel Permission**, the cleanest way is to use **middleware + role-based redirects**.

Below are **3 common and correct ways**, from **recommended â†’ advanced**.

---

## âœ… Method 1 (Recommended): Custom Role Redirect Middleware

### 1ï¸âƒ£ Create middleware

```bash
php artisan make:middleware RoleDashboardRedirect
```

### 2ï¸âƒ£ Middleware logic

`app/Http/Middleware/RoleDashboardRedirect.php`

```php
<?php

namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;
use Symfony\Component\HttpFoundation\Response;

class RoleDashboardRedirect
{
    public function handle(Request $request, Closure $next): Response
    {
        $user = auth()->user();

        if (!$user) {
            return redirect()->route('login');
        }

        if ($user->hasRole('admin')) {
            return redirect()->route('admin.dashboard');
        }

        if ($user->hasRole('staff')) {
            return redirect()->route('staff.dashboard');
        }

        if ($user->hasRole('manager')) {
            return redirect()->route('manager.dashboard');
        }

        return redirect()->route('home');
    }
}
```

---

### 3ï¸âƒ£ Register middleware

`app/Http/Kernel.php`

```php
protected $routeMiddleware = [
    'role.redirect' => \App\Http\Middleware\RoleDashboardRedirect::class,
];
```

---

### 4ï¸âƒ£ Apply middleware after login

```php
Route::get('/dashboard', function () {
    return view('dashboard');
})->middleware(['auth', 'role.redirect']);
```

Now:

* Admin â†’ `/admin/dashboard`
* Staff â†’ `/staff/dashboard`
* Manager â†’ `/manager/dashboard`

---

## âœ… Method 2: Spatie Built-in Role Middleware (Best for Route Protection)

Spatie already provides middleware:

### Register (if not already)

```php
'role' => \Spatie\Permission\Middlewares\RoleMiddleware::class,
```

### Routes

```php
Route::middleware(['auth', 'role:admin'])->group(function () {
    Route::get('/admin/dashboard', fn () => view('admin.dashboard'))
        ->name('admin.dashboard');
});

Route::middleware(['auth', 'role:staff'])->group(function () {
    Route::get('/staff/dashboard', fn () => view('staff.dashboard'))
        ->name('staff.dashboard');
});
```

â›” This **protects routes**, but does **not auto-redirect after login**.

---

## âœ… Method 3: Redirect by Role After Login (Fortify / Auth)

If youâ€™re using **Laravel Fortify / default auth**, override redirect logic:

### In `LoginController` (or Fortify Action)

```php
protected function authenticated($request, $user)
{
    if ($user->hasRole('admin')) {
        return redirect()->route('admin.dashboard');
    }

    if ($user->hasRole('staff')) {
        return redirect()->route('staff.dashboard');
    }

    return redirect('/home');
}
```

---

## ğŸ” Best Practice (Recommended Setup)

âœ” Use **Method 1** â†’ redirect logic
âœ” Use **Method 2** â†’ route protection

This gives you:

* Clean login redirect
* Secure dashboard access
* Scalable role handling

---

## ğŸ”¥ Pro Tip (Multiple Roles Support)

```php
if ($user->hasAnyRole(['admin', 'super-admin'])) {
    return redirect()->route('admin.dashboard');
}
```

---

If you want, tell me:

* Are you using **Jetstream / Fortify / Breeze**?
* Single role per user or **multiple roles**?

Iâ€™ll tailor it exactly for your setup ğŸš€
